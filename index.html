<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üçÑ Mushroom Hunter - Michigan Foraging Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e8e8e8;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 30px 0;
        }

        header h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, #76b852, #8dc26f);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        header p {
            color: #888;
            font-size: 1.1rem;
        }

        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 30px;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            margin-bottom: 30px;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #76b852;
        }

        .stat-label {
            font-size: 0.8rem;
            color: #888;
            text-transform: uppercase;
        }

        .game-card {
            background: rgba(255,255,255,0.08);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .mushroom-display {
            text-align: center;
            margin-bottom: 25px;
        }

        .mushroom-emoji {
            font-size: 8rem;
            margin-bottom: 15px;
            filter: drop-shadow(0 10px 20px rgba(0,0,0,0.3));
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .mushroom-name {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .mushroom-scientific {
            font-style: italic;
            color: #888;
            margin-bottom: 15px;
        }

        .mushroom-description {
            color: #aaa;
            line-height: 1.6;
            max-width: 500px;
            margin: 0 auto;
        }

        .question {
            text-align: center;
            font-size: 1.3rem;
            margin: 25px 0;
            color: #ddd;
        }

        .choices {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            max-width: 500px;
            margin: 0 auto;
        }

        .choice-btn {
            padding: 18px 25px;
            font-size: 1.1rem;
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            background: rgba(255,255,255,0.05);
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .choice-btn:hover {
            background: rgba(255,255,255,0.15);
            border-color: rgba(255,255,255,0.4);
            transform: translateY(-2px);
        }

        .choice-btn.correct {
            background: rgba(76, 175, 80, 0.3);
            border-color: #4caf50;
            animation: pulse-green 0.5s ease;
        }

        .choice-btn.wrong {
            background: rgba(244, 67, 54, 0.3);
            border-color: #f44336;
            animation: shake 0.5s ease;
        }

        @keyframes pulse-green {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .result-card {
            text-align: center;
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            display: none;
        }

        .result-card.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-card.correct {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid rgba(76, 175, 80, 0.4);
        }

        .result-card.wrong {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid rgba(244, 67, 54, 0.4);
        }

        .result-title {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .fun-fact {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            text-align: left;
        }

        .fun-fact h4 {
            color: #76b852;
            margin-bottom: 8px;
        }

        .next-btn {
            margin-top: 20px;
            padding: 15px 40px;
            font-size: 1.1rem;
            background: linear-gradient(90deg, #76b852, #8dc26f);
            border: none;
            border-radius: 30px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .next-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(118, 184, 82, 0.4);
        }

        .game-over {
            text-align: center;
            padding: 40px;
        }

        .game-over h2 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            background: linear-gradient(90deg, #76b852, #8dc26f);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .final-score {
            font-size: 4rem;
            font-weight: bold;
            color: #76b852;
            margin: 20px 0;
        }

        .grade {
            font-size: 1.5rem;
            margin-bottom: 30px;
        }

        .grade-title {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .play-again-btn {
            padding: 18px 50px;
            font-size: 1.2rem;
            background: linear-gradient(90deg, #76b852, #8dc26f);
            border: none;
            border-radius: 30px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .play-again-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 25px rgba(118, 184, 82, 0.5);
        }

        .start-screen {
            text-align: center;
            padding: 50px 20px;
        }

        .start-screen h2 {
            font-size: 2rem;
            margin-bottom: 20px;
        }

        .start-screen p {
            color: #aaa;
            margin-bottom: 30px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
        }

        .difficulty-select {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .difficulty-btn {
            padding: 12px 25px;
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            background: transparent;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .difficulty-btn.active {
            background: rgba(118, 184, 82, 0.3);
            border-color: #76b852;
        }

        .difficulty-btn:hover {
            border-color: rgba(255,255,255,0.5);
        }

        .warning-box {
            background: rgba(255, 152, 0, 0.2);
            border: 1px solid rgba(255, 152, 0, 0.4);
            border-radius: 10px;
            padding: 15px;
            margin: 20px auto;
            max-width: 500px;
        }

        .warning-box h4 {
            color: #ff9800;
            margin-bottom: 5px;
        }

        .warning-box p {
            color: #ddd;
            font-size: 0.9rem;
            margin: 0;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #76b852, #8dc26f);
            transition: width 0.3s ease;
        }

        @media (max-width: 600px) {
            header h1 { font-size: 1.8rem; }
            .mushroom-emoji { font-size: 5rem; }
            .choices { grid-template-columns: 1fr; }
            .stats-bar { flex-wrap: wrap; gap: 15px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üçÑ Mushroom Hunter</h1>
            <p>Michigan Foraging Identification Game</p>
        </header>

        <div id="app"></div>
    </div>

    <script>
        // Michigan Mushroom Database
        const mushrooms = [
            {
                name: "Morel",
                scientific: "Morchella esculenta",
                emoji: "üçÑ",
                appearance: "Honeycomb-like cap with ridges and pits, hollow inside, cream to dark brown color",
                habitat: "Found near dying elm, ash, and apple trees in spring (April-May)",
                answer: "edible",
                funFact: "Morels are Michigan's most prized wild mushroom! They can sell for $30-50 per pound. The key to finding them: look near dead or dying elm and ash trees after a warm spring rain when soil temps hit 50¬∞F.",
                difficulty: 1
            },
            {
                name: "Destroying Angel",
                scientific: "Amanita bisporigera",
                emoji: "üçÑ",
                appearance: "Pure white cap and stem, with a skirt-like ring and bulbous base with a cup (volva)",
                habitat: "Hardwood and mixed forests, summer through fall",
                answer: "deadly",
                funFact: "One of the deadliest mushrooms in North America! Contains amatoxins that cause liver failure. Just half a cap can be lethal. It's responsible for 90% of mushroom-related deaths. NEVER eat an all-white mushroom without expert identification!",
                difficulty: 1
            },
            {
                name: "Chicken of the Woods",
                scientific: "Laetiporus sulphureus",
                emoji: "üçÑ",
                appearance: "Bright orange and yellow shelf fungus, grows in overlapping clusters on trees",
                habitat: "On dead or dying oak, cherry, and other hardwoods",
                answer: "edible",
                funFact: "Named for its chicken-like texture when cooked! Best when young and tender. In Michigan, look for it from late summer through fall on oak trees. Some people are sensitive to it, so try a small amount first.",
                difficulty: 1
            },
            {
                name: "Jack O'Lantern",
                scientific: "Omphalotus olearius",
                emoji: "üçÑ",
                appearance: "Bright orange, grows in clusters at base of trees, gills glow faintly in the dark",
                habitat: "At the base of hardwood trees and stumps, late summer to fall",
                answer: "poisonous",
                funFact: "Often mistaken for edible Chanterelles! Key differences: Jack O'Lanterns grow in clusters on wood, have true gills, and actually glow in the dark (bioluminescence). Chanterelles grow from soil and have false gills. Causes severe GI distress but isn't deadly.",
                difficulty: 2
            },
            {
                name: "Giant Puffball",
                scientific: "Calvatia gigantea",
                emoji: "‚ö™",
                appearance: "Large white ball, can grow to soccer-ball size or larger, no stem, smooth surface",
                habitat: "Meadows, pastures, and open woods, late summer to fall",
                answer: "edible",
                funFact: "A single giant puffball can contain 7 TRILLION spores! Edible only when interior is pure white - if it's yellow or brown, it's past prime. Slice it like bread and fry in butter. Some specimens in Michigan have been found weighing over 40 pounds!",
                difficulty: 1
            },
            {
                name: "False Morel",
                scientific: "Gyromitra esculenta",
                emoji: "üçÑ",
                appearance: "Brain-like, wrinkled cap (not honeycomb), reddish-brown, stem is chambered not hollow",
                habitat: "Sandy soils near conifers, early spring",
                answer: "poisonous",
                funFact: "Contains gyromitrin which converts to toxic monomethylhydrazine (rocket fuel!) in your body. While some people eat them after special preparation, it's caused deaths. The key difference from true morels: brain-like wrinkles vs honeycomb pits, and chambered vs hollow stem.",
                difficulty: 2
            },
            {
                name: "Chanterelle",
                scientific: "Cantharellus cibarius",
                emoji: "üçÑ",
                appearance: "Golden yellow, funnel-shaped with wavy edges, false gills (ridges), fruity apricot smell",
                habitat: "Near oaks and conifers in moss, summer through fall",
                answer: "edible",
                funFact: "Chanterelles have a distinctive apricot-like aroma! They form mycorrhizal relationships with trees and can't be cultivated commercially. In Michigan, look in oak forests after summer rains. They're among the world's most popular wild edible mushrooms.",
                difficulty: 2
            },
            {
                name: "Fly Agaric",
                scientific: "Amanita muscaria",
                emoji: "üçÑ",
                appearance: "Iconic red cap with white spots, white gills, white stem with ring and bulbous base",
                habitat: "Under birch and pine trees, late summer to fall",
                answer: "poisonous",
                funFact: "The classic 'Mario mushroom' and fairy tale toadstool! Contains ibotenic acid and muscimol - causes delirium, not death (though still dangerous). Vikings may have used it for 'berserker' rage. It's been used in shamanic rituals for thousands of years.",
                difficulty: 1
            },
            {
                name: "Hen of the Woods",
                scientific: "Grifola frondosa",
                emoji: "üçÑ",
                appearance: "Large cluster of grayish-brown overlapping fan-shaped caps, grows at tree bases",
                habitat: "Base of oaks, especially old or dying trees, fall",
                answer: "edible",
                funFact: "Also called Maitake ('dancing mushroom' in Japanese)! Highly prized in both cooking and traditional medicine. A single cluster can weigh 50+ pounds. In Michigan, oak forests in fall are prime hunting grounds. The same spot often produces year after year!",
                difficulty: 2
            },
            {
                name: "Death Cap",
                scientific: "Amanita phalloides",
                emoji: "üçÑ",
                appearance: "Greenish-yellow to olive cap, white gills, white stem with skirt ring and cup at base",
                habitat: "Under oaks, introduced species becoming more common",
                answer: "deadly",
                funFact: "Responsible for most fatal mushroom poisonings worldwide! Symptoms don't appear for 6-12 hours, by which time liver damage is underway. There's no antidote - only liver transplant can save victims in severe cases. Originally European, now spreading in North America.",
                difficulty: 2
            },
            {
                name: "Oyster Mushroom",
                scientific: "Pleurotus ostreatus",
                emoji: "üçÑ",
                appearance: "Fan or oyster-shaped caps, white to gray to brown, short offset stem, white gills",
                habitat: "On dead hardwoods, especially in cooler weather, spring and fall",
                answer: "edible",
                funFact: "One of the easiest wild mushrooms to identify and one of the safest for beginners! They're also one of few mushrooms that are carnivorous - they trap and digest nematodes for nitrogen. Great beginner foraging mushroom in Michigan!",
                difficulty: 1
            },
            {
                name: "Lion's Mane",
                scientific: "Hericium erinaceus",
                emoji: "ü¶Å",
                appearance: "White, shaggy mass of cascading spines, no cap or gills, looks like a white pom-pom",
                habitat: "On dead or dying hardwoods, especially beech and maple, late summer to fall",
                answer: "edible",
                funFact: "Looks like a white waterfall! Studies show it may support brain health and nerve regeneration. Has a seafood-like taste similar to crab or lobster. No poisonous lookalikes make this a great beginner mushroom. Increasingly rare in the wild.",
                difficulty: 1
            },
            {
                name: "Earthball",
                scientific: "Scleroderma citrinum",
                emoji: "üü§",
                appearance: "Round like a puffball but with thick rubbery skin, interior is dark purple-black when cut",
                habitat: "Woodland paths and disturbed areas, summer to fall",
                answer: "poisonous",
                funFact: "Often mistaken for edible puffballs! The key difference: cut it open. Puffballs should be pure white inside like marshmallow. Earthballs have dark purple-black interiors even when young. Causes severe gastrointestinal upset.",
                difficulty: 2
            },
            {
                name: "Reishi",
                scientific: "Ganoderma lucidum",
                emoji: "üçÑ",
                appearance: "Kidney-shaped, shiny reddish-brown lacquered surface, grows as shelf on trees",
                habitat: "On hardwoods, especially oaks and maples, year-round",
                answer: "medicinal",
                funFact: "The 'Mushroom of Immortality' in Chinese medicine for over 2,000 years! Too woody to eat but used to make tea or extracts. Contains compounds being studied for immune support. Michigan's forests have several Ganoderma species.",
                difficulty: 2
            },
            {
                name: "Shaggy Mane",
                scientific: "Coprinus comatus",
                emoji: "üçÑ",
                appearance: "Tall white cylinder with shaggy scales, dissolves into black ink from bottom up when mature",
                habitat: "Disturbed ground, lawns, paths, roadsides, spring and fall",
                answer: "edible",
                funFact: "Must be eaten within hours of picking - it autodigests into black ink! The 'inky cap' process is called deliquescence. Best when young before the gills turn pink. Never consume alcohol within 3 days of eating any inky cap mushrooms!",
                difficulty: 2
            },
            {
                name: "Turkey Tail",
                scientific: "Trametes versicolor",
                emoji: "ü¶É",
                appearance: "Thin, flexible, fan-shaped brackets with colorful concentric zones like turkey feathers",
                habitat: "On dead hardwood logs and stumps, year-round",
                answer: "medicinal",
                funFact: "One of the most researched medicinal mushrooms! Contains PSK, used alongside cancer treatment in Japan. Too tough to eat but great for tea. The most common bracket fungus in Michigan - you've probably walked past thousands!",
                difficulty: 1
            },
            {
                name: "Black Trumpet",
                scientific: "Craterellus cornucopioides",
                emoji: "üñ§",
                appearance: "Funnel-shaped, thin-fleshed, dark gray to black, no gills, wavy edges",
                habitat: "In moss under oaks and beeches, summer to fall",
                answer: "edible",
                funFact: "Called 'black gold' by foragers! Despite the ominous appearance, they're delicious with an earthy, smoky flavor. Hard to spot - they blend into leaf litter. Nicknamed 'trompette de la mort' (trumpet of death) in French, but totally safe to eat!",
                difficulty: 2,
                season: [7, 8, 9]
            },
            {
                name: "Beefsteak Fungus",
                scientific: "Fistulina hepatica",
                emoji: "ü•©",
                appearance: "Thick, tongue-shaped bracket, blood-red and meaty looking, oozes red juice when cut",
                habitat: "On oaks and chestnuts, late summer to fall",
                answer: "edible",
                funFact: "Looks disturbingly like raw meat - even 'bleeds' red juice! Has a sour, tangy taste due to vitamin C content. In England, it's called 'ox tongue.' The wood it grows on becomes valuable 'brown oak' prized by woodworkers!",
                difficulty: 2,
                season: [8, 9, 10]
            },
            {
                name: "Deadly Galerina",
                scientific: "Galerina marginata",
                emoji: "üçÑ",
                appearance: "Small brown cap, brown gills, thin stem with faint ring, grows on wood",
                habitat: "On rotting wood, especially conifers, spring through fall",
                answer: "deadly",
                funFact: "Contains the same deadly amatoxins as Death Cap! Often mistaken for psychedelic Psilocybe mushrooms or edible Honey Mushrooms. Small but lethal - just a few can kill. Always check for wood substrate and do a spore print!",
                difficulty: 2,
                season: [4, 5, 6, 7, 8, 9, 10]
            },
            {
                name: "Honey Mushroom",
                scientific: "Armillaria mellea",
                emoji: "üçØ",
                appearance: "Honey-brown cap, white gills, ring on stem, grows in clusters at tree bases",
                habitat: "At base of trees and stumps, fall",
                answer: "edible",
                funFact: "One of the largest living organisms on Earth! A single Honey Mushroom colony in Oregon covers 2,385 acres and is estimated to be 2,400 years old. Must be cooked thoroughly - raw ones cause stomach upset. Great in stir-fries!",
                difficulty: 2,
                season: [9, 10, 11]
            },
            {
                name: "Chaga",
                scientific: "Inonotus obliquus",
                emoji: "‚¨õ",
                appearance: "Black, burnt-looking crusty growth on birch trees, interior is orange-brown",
                habitat: "On living birch trees, year-round",
                answer: "medicinal",
                funFact: "Not actually a mushroom but a sclerotia (mass of mycelium)! Used in Siberian folk medicine for centuries. Takes 5-7 years to mature. Harvesting kills the colony - please harvest sustainably! Makes a pleasant tea with vanilla notes.",
                difficulty: 2,
                season: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
            },
            {
                name: "Angel Wings",
                scientific: "Pleurocybella porrigens",
                emoji: "üëº",
                appearance: "Pure white, thin, fan-shaped, no stem, grows in overlapping shelves on conifers",
                habitat: "On dead conifer logs, especially hemlock, fall",
                answer: "poisonous",
                funFact: "Was considered edible until 2004 when 59 people in Japan were poisoned, 17 fatally! Now known to cause fatal brain damage in people with kidney problems. Looks similar to Oyster Mushrooms but grows on conifers, not hardwoods.",
                difficulty: 2,
                season: [9, 10, 11]
            },
            {
                name: "Indigo Milk Cap",
                scientific: "Lactarius indigo",
                emoji: "üîµ",
                appearance: "Striking blue color, exudes blue milk when cut, fades to grayish with age",
                habitat: "Under oaks and pines, summer to fall",
                answer: "edible",
                funFact: "One of the few blue foods in nature! The indigo color comes from azulene compounds. Taste is mildly peppery. Popular in Mexican and Guatemalan cuisine. When you cook it, the blue turns gray-green. Rare find in Michigan!",
                difficulty: 2,
                season: [7, 8, 9]
            },
            {
                name: "Parasol Mushroom",
                scientific: "Macrolepiota procera",
                emoji: "‚òÇÔ∏è",
                appearance: "Large (up to 12 inch cap), scaly brown cap, tall stem with moveable ring, snake-skin pattern on stem",
                habitat: "Meadows, pastures, forest edges, summer to fall",
                answer: "edible",
                funFact: "One of the largest and most elegant mushrooms! Cap can be breaded and fried like a schnitzel. The moveable ring is a key ID feature. Warning: has dangerous lookalikes in the Chlorophyllum genus that cause severe illness!",
                difficulty: 2,
                season: [7, 8, 9, 10]
            }
        ];

        // Game State
        let currentMushroom = 0;
        let score = 0;
        let streak = 0;
        let questionsAnswered = 0;
        let shuffledMushrooms = [];
        let selectedDifficulty = 'all';
        let totalQuestions = 10;
        let survivalMode = false;
        let gameOver = false;

        // High Scores
        function getHighScores() {
            const scores = localStorage.getItem('mushroomHunterScores');
            return scores ? JSON.parse(scores) : [];
        }

        function saveHighScore(score, mode) {
            const scores = getHighScores();
            scores.push({ score, mode, date: new Date().toLocaleDateString() });
            scores.sort((a, b) => b.score - a.score);
            localStorage.setItem('mushroomHunterScores', JSON.stringify(scores.slice(0, 10)));
        }

        // Seasonal data
        const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        
        function getSeasonalMushrooms(month) {
            const monthNum = month + 1; // JS months are 0-indexed
            return mushrooms.filter(m => {
                if (!m.season) {
                    // Default seasons based on common knowledge
                    if (m.name === 'Morel') return [4, 5].includes(monthNum);
                    if (m.name.includes('Puffball')) return [8, 9, 10].includes(monthNum);
                    return [5, 6, 7, 8, 9, 10].includes(monthNum); // General mushroom season
                }
                return m.season.includes(monthNum);
            });
        }

        // Shuffle array
        function shuffle(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        // Get mushrooms based on difficulty
        function getMushroomsByDifficulty() {
            if (selectedDifficulty === 'all') return mushrooms;
            return mushrooms.filter(m => m.difficulty === parseInt(selectedDifficulty));
        }

        // Render start screen
        function renderStartScreen() {
            const highScores = getHighScores().slice(0, 5);
            const currentMonth = new Date().getMonth();
            const inSeason = getSeasonalMushrooms(currentMonth);
            
            document.getElementById('app').innerHTML = `
                <div class="game-card start-screen">
                    <h2>Welcome, Forager! üå≤</h2>
                    <p>Test your knowledge of Michigan's wild mushrooms. Can you tell the difference between a delicious Morel and a deadly Destroying Angel?</p>
                    
                    <div class="warning-box">
                        <h4>‚ö†Ô∏è Safety Warning</h4>
                        <p>This game is for education only. NEVER eat wild mushrooms without expert verification. When in doubt, throw it out!</p>
                    </div>

                    <h3 style="margin: 25px 0 15px;">Select Difficulty</h3>
                    <div class="difficulty-select">
                        <button class="difficulty-btn ${selectedDifficulty === 'all' ? 'active' : ''}" onclick="setDifficulty('all')">All (${mushrooms.length})</button>
                        <button class="difficulty-btn ${selectedDifficulty === '1' ? 'active' : ''}" onclick="setDifficulty('1')">Easy</button>
                        <button class="difficulty-btn ${selectedDifficulty === '2' ? 'active' : ''}" onclick="setDifficulty('2')">Hard</button>
                    </div>

                    <h3 style="margin: 25px 0 15px;">Game Mode</h3>
                    <div class="difficulty-select">
                        <button class="difficulty-btn ${!survivalMode ? 'active' : ''}" onclick="setSurvivalMode(false)">üéÆ Normal</button>
                        <button class="difficulty-btn ${survivalMode ? 'active' : ''}" onclick="setSurvivalMode(true)">‚ò†Ô∏è Survival</button>
                    </div>
                    ${survivalMode ? '<p style="color: #ff6b6b; font-size: 0.9rem; margin-top: 10px;">Survival: Misidentify a DEADLY mushroom = Game Over!</p>' : ''}

                    <button class="play-again-btn" onclick="startGame()">Start Foraging! üçÑ</button>
                    
                    <button class="difficulty-btn" style="margin-top: 15px; width: 100%; max-width: 300px;" onclick="showCalendar()">üìÖ Seasonal Calendar</button>
                    
                    ${highScores.length > 0 ? `
                        <div style="margin-top: 30px; text-align: left; max-width: 400px; margin-left: auto; margin-right: auto;">
                            <h4 style="color: #76b852; margin-bottom: 10px;">üèÜ High Scores</h4>
                            <table style="width: 100%; font-size: 0.9rem;">
                                ${highScores.map((s, i) => `
                                    <tr style="color: ${i === 0 ? '#ffd700' : '#aaa'};">
                                        <td>${i + 1}.</td>
                                        <td>${s.score} pts</td>
                                        <td>${s.mode || 'Normal'}</td>
                                        <td style="text-align: right;">${s.date}</td>
                                    </tr>
                                `).join('')}
                            </table>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        function setSurvivalMode(enabled) {
            survivalMode = enabled;
            renderStartScreen();
        }

        function showCalendar() {
            const currentMonth = new Date().getMonth();
            
            document.getElementById('app').innerHTML = `
                <div class="game-card">
                    <h2 style="text-align: center; margin-bottom: 20px;">üìÖ Michigan Foraging Calendar</h2>
                    <p style="text-align: center; color: #888; margin-bottom: 25px;">Best times to find each species in Southeast Michigan</p>
                    
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; min-width: 600px; font-size: 0.8rem; border-collapse: collapse;">
                            <thead>
                                <tr style="background: rgba(255,255,255,0.1);">
                                    <th style="padding: 10px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.2);">Species</th>
                                    ${monthNames.map((m, i) => `
                                        <th style="padding: 5px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.2); ${i === currentMonth ? 'background: rgba(118,184,82,0.3);' : ''}">${m}</th>
                                    `).join('')}
                                </tr>
                            </thead>
                            <tbody>
                                ${mushrooms.filter(m => m.answer === 'edible' || m.answer === 'medicinal').map(m => {
                                    const seasons = m.season || getDefaultSeason(m.name);
                                    return `
                                        <tr>
                                            <td style="padding: 8px; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                                <strong>${m.name}</strong>
                                                <span style="color: ${m.answer === 'edible' ? '#76b852' : '#9c27b0'}; font-size: 0.7rem; margin-left: 5px;">${m.answer === 'edible' ? '‚úì' : 'üíä'}</span>
                                            </td>
                                            ${monthNames.map((_, i) => `
                                                <td style="padding: 5px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.1); ${i === currentMonth ? 'background: rgba(118,184,82,0.1);' : ''}">
                                                    ${seasons.includes(i + 1) ? 'üçÑ' : '¬∑'}
                                                </td>
                                            `).join('')}
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>

                    <div style="text-align: center; margin-top: 20px;">
                        <p style="color: #76b852; margin-bottom: 15px;">Current month highlighted ‚Ä¢ ‚úì = Edible ‚Ä¢ üíä = Medicinal only</p>
                        <button class="next-btn" onclick="renderStartScreen()">‚Üê Back to Game</button>
                    </div>
                </div>
            `;
        }

        function getDefaultSeason(name) {
            // Default seasons for mushrooms without explicit season data
            const seasons = {
                'Morel': [4, 5],
                'Destroying Angel': [6, 7, 8, 9],
                'Chicken of the Woods': [8, 9, 10],
                'Jack O\'Lantern': [9, 10],
                'Giant Puffball': [8, 9, 10],
                'False Morel': [4, 5],
                'Chanterelle': [6, 7, 8, 9],
                'Fly Agaric': [8, 9, 10],
                'Hen of the Woods': [9, 10],
                'Death Cap': [8, 9, 10],
                'Oyster Mushroom': [4, 5, 10, 11],
                'Lion\'s Mane': [8, 9, 10],
                'Earthball': [7, 8, 9, 10],
                'Reishi': [6, 7, 8, 9, 10],
                'Shaggy Mane': [9, 10, 11],
                'Turkey Tail': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
            };
            return seasons[name] || [6, 7, 8, 9, 10];
        }

        function setDifficulty(diff) {
            selectedDifficulty = diff;
            renderStartScreen();
        }

        // Start game
        function startGame() {
            const availableMushrooms = getMushroomsByDifficulty();
            shuffledMushrooms = shuffle(availableMushrooms).slice(0, totalQuestions);
            currentMushroom = 0;
            score = 0;
            streak = 0;
            questionsAnswered = 0;
            gameOver = false;
            renderQuestion();
        }

        // Render question
        function renderQuestion() {
            const m = shuffledMushrooms[currentMushroom];
            const progress = ((currentMushroom) / shuffledMushrooms.length) * 100;
            
            document.getElementById('app').innerHTML = `
                <div class="stats-bar">
                    <div class="stat">
                        <div class="stat-value">${score}</div>
                        <div class="stat-label">Score</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value">${streak}üî•</div>
                        <div class="stat-label">Streak</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value">${currentMushroom + 1}/${shuffledMushrooms.length}</div>
                        <div class="stat-label">Question</div>
                    </div>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${progress}%"></div>
                </div>

                <div class="game-card">
                    <div class="mushroom-display">
                        <div class="mushroom-emoji">${m.emoji}</div>
                        <div class="mushroom-name">${m.name}</div>
                        <div class="mushroom-scientific">${m.scientific}</div>
                        <div class="mushroom-description">
                            <strong>Appearance:</strong> ${m.appearance}<br><br>
                            <strong>Habitat:</strong> ${m.habitat}
                        </div>
                    </div>

                    <div class="question">Is this mushroom safe to eat?</div>

                    <div class="choices">
                        <button class="choice-btn" onclick="checkAnswer('edible')">‚úÖ Edible</button>
                        <button class="choice-btn" onclick="checkAnswer('poisonous')">‚ò†Ô∏è Poisonous</button>
                        <button class="choice-btn" onclick="checkAnswer('deadly')">üíÄ Deadly</button>
                        <button class="choice-btn" onclick="checkAnswer('medicinal')">üíä Medicinal Only</button>
                    </div>

                    <div id="result" class="result-card"></div>
                </div>
            `;
        }

        // Check answer
        function checkAnswer(answer) {
            const m = shuffledMushrooms[currentMushroom];
            const isCorrect = answer === m.answer;
            const ateFatal = !isCorrect && m.answer === 'deadly';
            
            // Disable buttons
            document.querySelectorAll('.choice-btn').forEach(btn => {
                btn.disabled = true;
                if (btn.textContent.toLowerCase().includes(m.answer)) {
                    btn.classList.add('correct');
                } else if (btn.textContent.toLowerCase().includes(answer) && !isCorrect) {
                    btn.classList.add('wrong');
                }
            });

            // Update score
            if (isCorrect) {
                streak++;
                score += 10 + (streak * 2); // Bonus for streak
            } else {
                streak = 0;
            }
            questionsAnswered++;

            // Check for survival mode death
            if (survivalMode && ateFatal) {
                gameOver = true;
                const resultDiv = document.getElementById('result');
                resultDiv.className = `result-card show wrong`;
                resultDiv.innerHTML = `
                    <div class="result-title" style="font-size: 2rem;">‚ò†Ô∏è YOU DIED ‚ò†Ô∏è</div>
                    <p style="font-size: 1.1rem; margin: 15px 0;">You ate a ${m.name} - it was <strong>DEADLY</strong>!</p>
                    <p style="color: #ff6b6b; font-style: italic;">"In the forest, there are old foragers and bold foragers, but no old, bold foragers."</p>
                    <div class="fun-fact">
                        <h4>üçÑ What killed you</h4>
                        <p>${m.funFact}</p>
                    </div>
                    <p style="margin-top: 20px; color: #888;">Final Score: <strong style="color: #76b852; font-size: 1.3rem;">${score}</strong> points</p>
                    <button class="next-btn" style="background: linear-gradient(90deg, #f44336, #d32f2f);" onclick="renderStartScreen()">Try Again (Don't eat that!) üíÄ</button>
                `;
                saveHighScore(score, 'Survival ‚ò†Ô∏è');
                return;
            }

            // Show result
            const resultDiv = document.getElementById('result');
            resultDiv.className = `result-card show ${isCorrect ? 'correct' : 'wrong'}`;
            resultDiv.innerHTML = `
                <div class="result-title">${isCorrect ? '‚úÖ Correct!' : '‚ùå Wrong!'}</div>
                <p>${isCorrect ? 'Great identification!' : `This is actually ${m.answer === 'deadly' ? 'DEADLY ‚ò†Ô∏è - you would have died!' : m.answer}.`}</p>
                <div class="fun-fact">
                    <h4>üçÑ Forager's Note</h4>
                    <p>${m.funFact}</p>
                </div>
                <button class="next-btn" onclick="nextQuestion()">${currentMushroom < shuffledMushrooms.length - 1 ? 'Next Mushroom ‚Üí' : 'See Results üèÜ'}</button>
            `;
        }

        // Next question
        function nextQuestion() {
            currentMushroom++;
            if (currentMushroom >= shuffledMushrooms.length) {
                showResults();
            } else {
                renderQuestion();
            }
        }

        // Show final results
        function showResults() {
            const percentage = Math.round((score / (shuffledMushrooms.length * 12)) * 100);
            let grade, gradeEmoji;
            
            if (percentage >= 90) {
                grade = "Master Mycologist";
                gradeEmoji = "üèÜ";
            } else if (percentage >= 70) {
                grade = "Expert Forager";
                gradeEmoji = "üåü";
            } else if (percentage >= 50) {
                grade = "Apprentice Hunter";
                gradeEmoji = "üçÑ";
            } else if (percentage >= 30) {
                grade = "Cautious Beginner";
                gradeEmoji = "üå±";
            } else {
                grade = "Stay Out of the Woods";
                gradeEmoji = "‚ò†Ô∏è";
            }

            // Save high score
            saveHighScore(score, survivalMode ? 'Survival üèÜ' : 'Normal');

            document.getElementById('app').innerHTML = `
                <div class="game-card game-over">
                    <h2>Hunt Complete! ${gradeEmoji}</h2>
                    <div class="final-score">${score}</div>
                    <p style="color: #888; margin-bottom: 20px;">points${survivalMode ? ' (Survival Mode!)' : ''}</p>
                    
                    <div class="grade">
                        <div class="grade-title">${grade}</div>
                        <p style="color: #888;">${percentage}% accuracy</p>
                    </div>

                    ${survivalMode ? `
                        <div style="background: rgba(76, 175, 80, 0.2); border: 1px solid rgba(76, 175, 80, 0.4); border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                            <h4 style="color: #76b852;">üéâ Survival Bonus!</h4>
                            <p>You completed survival mode without eating anything deadly!</p>
                        </div>
                    ` : ''}

                    <div class="warning-box" style="margin-bottom: 30px;">
                        <h4>Remember!</h4>
                        <p>When foraging in the wild: "When in doubt, throw it out!" Always consult an expert before eating wild mushrooms.</p>
                    </div>

                    <button class="play-again-btn" onclick="renderStartScreen()">Hunt Again üçÑ</button>
                </div>
            `;
        }

        // Initialize
        renderStartScreen();
    </script>
</body>
</html>
